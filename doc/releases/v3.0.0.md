# v3.0.0

## How to install

**Step 1**: Verify mysql version and update .env.local

    mysql --version

If the server is using MariaDB, the minimum version required is *10.5.2*. Update your server if the requirement is not met.

Make sure `.env.local` contains

    APP_ENV=prod

**Step 2**: MySQL Backup

    mysqldump wdc_styleguide > /root/mysql_23_04_11.sql

**Step 3**: Add GitHub Token

Go to https://github.com/settings/tokens and create a classic token with `repo` access. Then run

    composer config -g github-oauth.github.com XXXXXXXXXX

**Step 4**: Disable webserver

    systemctl stop apache2

**Step 5**: Move old wirhub as backup

    mv wirHub wirhub-deprecated

**Step 6**: Clone new repository

    git clone git@github.com:wirDesign-communication-AG/wirhub-app.git wirhub/

**Step 7**: Move files

	mkdir wirhub/files
    mv wirhub-deprecated/.env.local wirhub/
    mv wirhub-deprecated/files/* wirhub/files/
    mv wirhub-deprecated/src/AppBundle/Resources/theme/ wirhub/files/

**Step 8**: Composer setup

    cd wirhub && COMPOSER_ALLOW_SUPERUSER=1 composer install --no-dev --optimize-autoloader

**Step 9**: Verify migrations before execution

    php bin/console doctrine:migrations:status

There will be 1 `new` migration if everything is alright.

**Step 10**: Migrate database

    php bin/console doctrine:migrations:migrate

Do not proceed if this step fails! Copy the error message and reimport your mysql dump (Step 1).

**Step 11**: Add locale for german installations to `.env.local`

    APP_LOCALE=de

**Step 12**: Execute one full update

    make update

**Step 13**: Update vhost

The new public folder is `public/` instead of `web/`

**Step 14**: Fix cronjobs

If the old wirHub did not use lowercase folder name, you have to change the path for cronjobs.

**Step 15**: Reenable webserver

    systemctl start apache2

## Vendors

- aws/aws-sdk-php (3.262.4 => 3.263.2)
- doctrine/data-fixtures (1.6.3 => 1.6.5)
- php-http/discovery (1.15.2 => 1.15.3)
- phpstan/phpdoc-parser (1.16.1 => 1.17.0)
- phpstan/phpstan (1.10.9 => 1.10.10)
- psr/http-message (1.0.1 => 1.1)
- symfony/string (v5.4.21 => v5.4.22)
